import gulp from 'gulp';
import browserify from 'browserify';
import buffer from 'vinyl-buffer';
import source from 'vinyl-source-stream';

import './build';

const buildDir = '<%- buildDir %>';
const bundleRoot = '<%- bundleRoot %>';
const bundleName = '<%- bundleName %>';

export const bundle = () => {
  return browserify(bundleRoot)<%- externalReact %>
    .bundle()
    .pipe(source(bundleName))
    .pipe(buffer())
    .pipe(gulp.dest(buildDir));
};

gulp.task('bundle', gulp.series('build', bundle));
