import {expect} from 'chai';
import <%- pluginFunc %> from '<%- pluginPath %>';
import {makeSingleTest} from 'child-process-data';

describe('Testing Gulp plugin <%- pluginFunc %>', function () {
  this.timeout('10000');

  it(`Running gulpfile '<%- gulpfilePath %>'`, function () {
    const test = makeSingleTest({
      childProcess: ['gulp', ['--gulpfile', '<%- gulpfilePath %>']],
      checkResults (results) {
        expect(results.out()).to.match(
          /Requiring external module babel-register/);
        expect(results.out()).to.match(
          /Working directory changed to/);
        expect(results.out()).to.match(
          /Using gulpfile/);
        expect(results.out()).to.match(
          /Starting 'default'.../);
        expect(results.out()).to.match(
          /Finished 'default' after/);
      },
    });
    return test();
  })
});
