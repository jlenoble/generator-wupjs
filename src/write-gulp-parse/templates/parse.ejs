import gulp from 'gulp';
import antlr4 from 'gulp-antlr4';

<%- consts %>
export const makeParser = () => {
  return gulp.src(grammarGlob, {
    since: gulp.lastRun(makeParser),
  })
    .pipe(antlr4(parserDir));
};

export const parse = () => {
  return gulp.src(dataGlob, {
    since: gulp.lastRun(parse),
  })
    .pipe(antlr4({
      grammar, parserDir, <%- options %>rule,
    }));
};

gulp.task('parse', gulp.series(makeParser, parse));
