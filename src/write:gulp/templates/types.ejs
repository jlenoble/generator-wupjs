import gulp from "gulp";
import ts from "gulp-typescript";
import merge from "merge2";

const buildDir = "<%- buildDir %>";
const libGlob = <%- libGlob %>;
const tsProject = ts.createProject("tsconfig.json");

const handleTypes = () => {
  const tsResult = gulp.src(libGlob, {
    base: process.cwd(),
    since: gulp.lastRun(handleTypes)
  })
    .pipe(tsProject());

  return merge([
    tsResult.dts.pipe(gulp.dest(buildDir)),
    tsResult.js.pipe(gulp.dest(buildDir))
  ]);
};

gulp.task("types", handleTypes);
